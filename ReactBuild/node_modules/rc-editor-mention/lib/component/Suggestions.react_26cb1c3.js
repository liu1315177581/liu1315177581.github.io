define("87a1ebe20c0976a811f7",function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var r=n[o],a=Object.getOwnPropertyDescriptor(t,r);a&&a.configurable&&void 0===e[r]&&Object.defineProperty(e,r,a)}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):r(e,t))}Object.defineProperty(t,"__esModule",{value:!0});var p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},c=e("53ab468d896ac9e0f717"),u=o(c),f=e("21bb258da0a791b110a7"),d=o(f),g=e("91ce1f8305bce0e052eb"),h=e("a6a04bbf387d36cfa021"),y=o(h),b=e("961a0cfb32e8002c95e8"),v=o(b),w=e("fb02cec47c7eeb1a0fae"),m=o(w),S=e("81a8edff0509a9662e5e"),O=o(S),D=e("704044604001ace81014"),P=o(D),T=e("3b2f7e6d2b87118fd1e0"),C=o(T),k=e("ab1d0f1140068dbca9f5"),E=o(k),x=e("6cc728bd2d7b695f4452"),j=o(x),K=e("00fb61b6058904b6bda8"),I=o(K),M=e("562e335d210f7ead89d3"),N=o(M),R=function(e){return e!==!1},A=function(e){function t(){s(this,t);var n=i(this,e.call(this));return n.onEditorStateChange=function(e){var t=n.props.store.getOffset();if(0===t.size)return e;var o=e.getSelection();if(!n.props.callbacks.getEditorState().getSelection().getHasFocus()&&o.getHasFocus())return e;var r=N["default"](e,o),a=r.word;if(!a)return n.closeDropDown(),e;var s=t.map(function(t){var n=t.offsetKey,r=g.decode(n),s=r.blockKey,i=r.decoratorKey,l=r.leafKey;if(s!==o.anchorKey)return!1;var p=e.getBlockTree(s).getIn([i,"leaves",l]);if(!p)return!1;var c=p.get("start"),u=p.get("end");return a?c===u-1?o.anchorOffset>=c+1&&o.anchorOffset<=u?n:!1:o.anchorOffset>c+1&&o.anchorOffset<=u?n:!1:!1}),i=s.some(R);n.activeOffsetKey=s.find(R);var l=n.props.store.getTrigger(n.activeOffsetKey);if(!i||!o.getHasFocus())return n.closeDropDown(),e;var p=a.substring(l.length,a.length);return(n.lastSearchValue!==p||n.lastTrigger!==l)&&(n.lastSearchValue=p,n.lastTrigger=l,n.props.onSearchChange(p,l)),n.state.active||n.openDropDown(),e},n.onUpArrow=function(e){if(e.preventDefault(),n.props.suggestions.length>0){var t=n.state.focusedIndex-1;n.setState({focusedIndex:Math.max(t,0)})}},n.onBlur=function(e){e.preventDefault(),n.closeDropDown()},n.onDownArrow=function(e){e.preventDefault();var t=n.state.focusedIndex+1;n.setState({focusedIndex:t>=n.props.suggestions.length?0:t})},n.getContainer=function(){var e=document.createElement("div"),t=void 0;return n.props.getSuggestionContainer?(t=n.props.getSuggestionContainer(),e.style.position="relative"):t=document.body,t.appendChild(e),e},n.handleKeyBinding=function(e){return"split-block"===e},n.handleReturn=function(e){e.preventDefault();var t=n.props.suggestions[n.state.focusedIndex];return t?(u["default"].isValidElement(t)?n.onMentionSelect(t.props.value,t.props.data):n.onMentionSelect(t),n.lastSearchValue=null,n.lastTrigger=null,!0):!1},n.renderReady=function(){var e=d["default"].findDOMNode(n.refs.focusItem),t=n.refs.dropdownContainer;if(t){var o=n.state.active,r=n.activeOffsetKey,a=n.props.store.getOffset(),s=a.get(r);if(o&&s){var i=n.getPositionStyle(!0,s.position());Object.keys(i).forEach(function(e){t.style[e]=i[e]})}e&&m["default"](e,t,{onlyScrollIfNeeded:!0})}},n.getNavigations=function(){var e=n.props,t=e.prefixCls,o=e.suggestions,r=n.state.focusedIndex;return o.length?u["default"].Children.map(o,function(e,o){var a=o===r,s=a?"focusItem":null,i=v["default"](t+"-dropdown-item",{focus:a});return u["default"].isValidElement(e)?u["default"].cloneElement(e,{className:i,onMouseDown:n.onMentionSelect.bind(n,e.props.value,e.props.data),ref:s}):u["default"].createElement(O["default"],{ref:s,className:i,onMouseDown:n.onMentionSelect.bind(n,e)},e)},n):u["default"].createElement("div",{className:t+"-dropdown-notfound "+t+"-dropdown-item"},n.props.notFoundContent)},n.state={isActive:!1,focusedIndex:0,container:!1},n}return l(t,e),t.prototype.componentDidMount=function(){this.props.callbacks.onChange=this.onEditorStateChange},t.prototype.componentWillReceiveProps=function(e){e.suggestions.length!==this.props.suggestions.length&&this.setState({focusedIndex:0})},t.prototype.onMentionSelect=function(e,t){var n=this.props.callbacks.getEditorState(),o=this.props,r=o.store,a=o.onSelect,s=r.getTrigger(this.activeOffsetKey);if(a&&a(e,t||e),this.props.noRedup){var i=I["default"](n,s);if(-1!==i.indexOf(""+s+e))return console.warn("you have specified `noRedup` props but have duplicated mentions."),this.closeDropDown(),void this.props.callbacks.setEditorState(E["default"](n))}this.props.callbacks.setEditorState(C["default"](n,""+s+e,t,this.props.mode),!0),this.closeDropDown()},t.prototype.getPositionStyle=function(e,t){if(this.props.getSuggestionStyle)return this.props.getSuggestionStyle(e,t);var n=this.props.getSuggestionContainer?this.state.container:document.body,o=j["default"](n);return t?p({position:"absolute",left:t.left-o.left+"px",top:t.top-o.top+"px"},this.props.style):{}},t.prototype.openDropDown=function(){this.props.callbacks.onUpArrow=this.onUpArrow,this.props.callbacks.handleReturn=this.handleReturn,this.props.callbacks.handleKeyBinding=this.handleKeyBinding,this.props.callbacks.onDownArrow=this.onDownArrow,this.props.callbacks.onBlur=this.onBlur,this.setState({active:!0,container:this.state.container||this.getContainer()})},t.prototype.closeDropDown=function(){this.props.callbacks.onUpArrow=null,this.props.callbacks.handleReturn=null,this.props.callbacks.handleKeyBinding=null,this.props.callbacks.onDownArrow=null,this.props.callbacks.onBlur=null,this.setState({active:!1})},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=(e.suggestions,e.className),o=this.state.container,r=v["default"](p(a({},t+"-dropdown",!0),n)),s=this.getNavigations();return o?u["default"].createElement(P["default"],{renderReady:this.renderReady,container:o},u["default"].createElement(y["default"],{transitionName:"slide-up"},this.state.active?u["default"].createElement("div",{className:r,ref:"dropdownContainer"},s):null)):null},t}(u["default"].Component);t["default"]=A,A.propTypes={callbacks:u["default"].PropTypes.object,suggestions:u["default"].PropTypes.array,store:u["default"].PropTypes.object,onSearchChange:u["default"].PropTypes.func,prefix:u["default"].PropTypes.oneOfType([u["default"].PropTypes.string,u["default"].PropTypes.arrayOf(u["default"].PropTypes.string)]),prefixCls:u["default"].PropTypes.string,mode:u["default"].PropTypes.string,style:u["default"].PropTypes.object,onSelect:u["default"].PropTypes.func,getSuggestionContainer:u["default"].PropTypes.func,notFoundContent:u["default"].PropTypes.any,getSuggestionStyle:u["default"].PropTypes.func,className:u["default"].PropTypes.string,noRedup:u["default"].PropTypes.bool},n.exports=t["default"]});